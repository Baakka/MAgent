language: python
jobs:
  include:
  - name: Python on Linux
    sudo: required
    services:
      - docker
    script:
      - export DOCKER_IMAGE=quay.io/pypa/manylinux2010_x86_64
      - export PLAT=manylinux2010_x86_64
      - docker pull quay.io/pypa/manylinux2010_x86_64
      - docker run --rm -e PLAT=$PLAT -v `pwd`:/io $DOCKER_IMAGE $PRE_CMD /io/travis/build-wheels.sh
      - cp -a wheelhouse/. .

  - name: "Python on macOS"
    os: osx
    osx_image: xcode11.4
    addons:
      homebrew:
        packages:
          - swig
          - llvm
    language: shell
    script: 
      - pip3 install pathlib
      - pip3 install twine
      - python3 setup.py bdist_wheel
      - cp -a dist/. .

install:
  - pip3 install wheel
  - pip3 install -r requirements.txt



deploy:
  skip_cleanup: true
  provider: pypi
  user: MarioJ
  password:
    secure: CkDxXOHxJdJIXdnkEqDSTR0EG1+aqvNToLtn4d6kWFjUWvzm/vxqkSZWCIemJNPafnocRyKC1qDWiBvdsuDGp2TZOms73ZGvXYuUwF35ZlLxyG339u4ulzn7j8C3fP/q5930hj2vxhzry6eKktInbtba+1OHhNIIyeZ1UE8ZDxfcNkta+5tsKbDQ4QObTrXk0f9fiGZ1tbjWgmCAawaRbBEdO+5xMYnwTZZzSlby3AxHaqdCqqle4pvSRiQFD6Dh1OqFgMHU5+A+mpHqzMXOE3b9Yg+TYI8dMGa/JOOccDfcsXDZf9DA65JvsnFsleqFznteEs1KJESyh6oKpEtZMru5ccMzFjpzY5PB8CQT7oDU6c/dUgjcU12dFxnTI8Ch8kIhsmRRTFWyYfPnTI7W2695GczftuJC5J5oD0/r2dSWO/CysJ6ZY/T/TScuVCJearlmR+wLBEdqTJk+SZW57v7VPNyXbbvJ+ZpodWzFVJSp4zzRP/bsOZ72rncWNvAcbbeVCYB06TYIJx9cVyz6zIhTt5UtT1zX92tcgOsbdXvhdnt1M1jRRFhvLXZcQ/2MbLj89eOkUjaG4vwPasK8DDrc2feqoQF+Vlx23VDhfA/fF9oByjjnKyvawbZNHXWRgS+p+E5zBSzPvhk2bkU3wvNnOo7REq/SC1Z/uMu3ZZo=
  on:
    branch: production
  distributions: "sdist bdist_wheel"
  skip_existing: true